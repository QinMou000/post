<blockquote> <br> <p style="text-align:center;"><img alt="" height="412" src="https://i-blog.csdnimg.cn/direct/6cba51481e444fb6b602b9ddab2084cd.png" width="854" /></p> <br> <p style="text-align:center;">✨✨作者主页：<a href="https://blog.csdn.net/2301_80194476?spm=1000.2115.3001.5343" title="嶔某">嶔某</a>✨✨</p> <br> <p style="text-align:center;">✨✨所属专栏：<a href="https://blog.csdn.net/2301_80194476/category_12841400.html?spm=1001.2014.3001.5482" title="MySql">MySql</a>✨</p> <br></blockquote> <br><p>准备工作，创建一个雇员信息表（来自oracle 9i的经典测试表）</p> <br><ul><li>EMP员工表</li><li>DEPT部门表</li><li>SALGRADE工资等级表</li></ul> <br><p><img alt="" height="185" src="https://i-blog.csdnimg.cn/direct/204f175f00944b38add0f4772daa97bb.png" width="344" /><img alt="" height="185" src="https://i-blog.csdnimg.cn/direct/82e5a911c2c54382a43b65a4d50fdf44.png" width="263" /><img alt="" height="425" src="https://i-blog.csdnimg.cn/direct/7ee50eef37a74e65ab7d11ee38689d95.png" width="829" /></p> <br><h2>多表查询</h2> <br><ul><li>显示雇员名，雇员工资以及所在部门的名字</li></ul> <br><p>因为上面的数据来自EMP和DEPT，所以要联合查询</p> <br><pre><code class="language-sql">mysql> select ename, sal, emp.deptno from emp, dept <br>     > where emp.deptno=dept.deptno;<br>+--------+---------+--------+<br>| ename  | sal     | deptno |<br>+--------+---------+--------+<br>| SMITH  |  800.00 |     20 |<br>| ALLEN  | 1600.00 |     30 |<br>| WARD   | 1250.00 |     30 |<br>| JONES  | 2975.00 |     20 |<br>| MARTIN | 1250.00 |     30 |<br>| BLAKE  | 2850.00 |     30 |<br>| CLARK  | 2450.00 |     10 |<br>| SCOTT  | 3000.00 |     20 |<br>| KING   | 5000.00 |     10 |<br>| TURNER | 1500.00 |     30 |<br>| ADAMS  | 1100.00 |     20 |<br>| JAMES  |  950.00 |     30 |<br>| FORD   | 3000.00 |     20 |<br>| MILLER | 1300.00 |     10 |<br>+--------+---------+--------+<br>14 rows in set (0.01 sec)</code></pre> <br><ul><li>显示部门号为10的部门，员工名和工资</li></ul> <br><pre><code class="language-sql">mysql> select dname,ename,sal from emp,dept <br>     > where emp.deptno=dept.deptno and emp.deptno=10;<br>+------------+--------+---------+<br>| dname      | ename  | sal     |<br>+------------+--------+---------+<br>| ACCOUNTING | CLARK  | 2450.00 |<br>| ACCOUNTING | KING   | 5000.00 |<br>| ACCOUNTING | MILLER | 1300.00 |<br>+------------+--------+---------+<br>3 rows in set (0.00 sec)</code></pre> <br><ul><li>显示各个员工的姓名、工资、工资级别</li></ul> <br><pre><code class="language-sql">mysql> select ename, sal, grade from emp, salgrade <br>     > where emp.sal between losal and hisal;<br>+--------+---------+-------+<br>| ename  | sal     | grade |<br>+--------+---------+-------+<br>| SMITH  |  800.00 |     1 |<br>| ALLEN  | 1600.00 |     3 |<br>| WARD   | 1250.00 |     2 |<br>| JONES  | 2975.00 |     4 |<br>| MARTIN | 1250.00 |     2 |<br>| BLAKE  | 2850.00 |     4 |<br>| CLARK  | 2450.00 |     4 |<br>| SCOTT  | 3000.00 |     4 |<br>| KING   | 5000.00 |     5 |<br>| TURNER | 1500.00 |     3 |<br>| ADAMS  | 1100.00 |     1 |<br>| JAMES  |  950.00 |     1 |<br>| FORD   | 3000.00 |     4 |<br>| MILLER | 1300.00 |     2 |<br>+--------+---------+-------+<br>14 rows in set (0.06 sec)</code></pre> <br><h2>自连接</h2> <br><p> 自连接是指在同一张表中连接查询</p> <br><ul><li>显示员工FORD的上级领导的编号和姓名（mgr是员工领导的编号-empno）</li></ul> <br><p><span style="color:#b95514;">使用子查询： </span></p> <br><pre><code class="language-sql">mysql> select ename,empno from emp <br>     > where (select mgr from emp where ename='FORD')=empno;<br>+-------+--------+<br>| ename | empno  |<br>+-------+--------+<br>| JONES | 007566 |<br>+-------+--------+<br>1 row in set (0.00 sec)</code></pre> <br><p><span style="color:#b95514;">使用多表查询（自查询）： </span></p> <br><pre><code class="language-sql">mysql> select leader.ename, leader.empno from emp leader,emp worker <br>     > where leader.empno=worker.mgr and worker.ename='FORD';<br>+-------+--------+<br>| ename | empno  |<br>+-------+--------+<br>| JONES | 007566 |<br>+-------+--------+<br>1 row in set (0.02 sec)</code></pre> <br><h2>子查询</h2> <br><p>子查询是指嵌入在其他sql语句中的select语句，也叫嵌套语句</p> <br><h3> 单行子查询</h3> <br><p>只返回一行记录的子查询</p> <br><ul><li>显示SMITH同一部门的员工</li></ul> <br><pre><code class="language-sql">mysql> select * from emp where (select deptno from emp where ename='SMITH')=deptno;<br>+--------+-------+---------+------+---------------------+---------+------+--------+<br>| empno  | ename | job     | mgr  | hiredate            | sal     | comm | deptno |<br>+--------+-------+---------+------+---------------------+---------+------+--------+<br>| 007369 | SMITH | CLERK   | 7902 | 1980-12-17 00:00:00 |  800.00 | NULL |     20 |<br>| 007566 | JONES | MANAGER | 7839 | 1981-04-02 00:00:00 | 2975.00 | NULL |     20 |<br>| 007788 | SCOTT | ANALYST | 7566 | 1987-04-19 00:00:00 | 3000.00 | NULL |     20 |<br>| 007876 | ADAMS | CLERK   | 7788 | 1987-05-23 00:00:00 | 1100.00 | NULL |     20 |<br>| 007902 | FORD  | ANALYST | 7566 | 1981-12-03 00:00:00 | 3000.00 | NULL |     20 |<br>+--------+-------+---------+------+---------------------+---------+------+--------+<br>5 rows in set (0.00 sec)</code></pre> <br><h3>多行子查询</h3> <br><p>返回多行记录的子查询</p> <br><ul><li>in关键字：查询和10号部门的工作岗位相同的雇员的名字、岗位、工资、部门号但是不包括10自己的</li></ul> <br><pre><code class="language-sql">mysql> select ename, job, deptno from emp <br>     > where job in (select job from emp where deptno=10) <br>     > and deptno<>10;<br>+-------+---------+--------+<br>| ename | job     | deptno |<br>+-------+---------+--------+<br>| SMITH | CLERK   |     20 |<br>| JONES | MANAGER |     20 |<br>| BLAKE | MANAGER |     30 |<br>| ADAMS | CLERK   |     20 |<br>| JAMES | CLERK   |     30 |<br>+-------+---------+--------+<br>5 rows in set (0.00 sec)</code></pre> <br><ul><li>all关键字：显示工资比部门30的所有员工的工资高的员工的姓名、工资、部门号</li></ul> <br><pre><code class="language-sql">mysql> select ename, sal, deptno from emp <br>     > where sal > all (select sal from emp where deptno=30);<br>+-------+---------+--------+<br>| ename | sal     | deptno |<br>+-------+---------+--------+<br>| JONES | 2975.00 |     20 |<br>| SCOTT | 3000.00 |     20 |<br>| KING  | 5000.00 |     10 |<br>| FORD  | 3000.00 |     20 |<br>+-------+---------+--------+<br>4 rows in set (0.01 sec)<br></code></pre> <br><ul><li>any关键字：显示工资比部门30的任意员工的工资高的员工的姓名、工资、部门号（包含自己部门的员工）</li></ul> <br><pre><code class="language-sql">mysql> select ename, sal, deptno from emp <br>     > where sal > any(select sal from emp where deptno=30);<br>+--------+---------+--------+<br>| ename  | sal     | deptno |<br>+--------+---------+--------+<br>| ALLEN  | 1600.00 |     30 |<br>| WARD   | 1250.00 |     30 |<br>| JONES  | 2975.00 |     20 |<br>| MARTIN | 1250.00 |     30 |<br>| BLAKE  | 2850.00 |     30 |<br>| CLARK  | 2450.00 |     10 |<br>| SCOTT  | 3000.00 |     20 |<br>| KING   | 5000.00 |     10 |<br>| TURNER | 1500.00 |     30 |<br>| ADAMS  | 1100.00 |     20 |<br>| FORD   | 3000.00 |     20 |<br>| MILLER | 1300.00 |     10 |<br>+--------+---------+--------+<br>12 rows in set (0.01 sec)</code></pre> <br><h3>多列子查询</h3> <br><p>单行<span style="color:#333333;">子查询是指子查询只返回单列，单行数据；多行子查询是指返回单列多行数据，都是针对单列而言的，而多列子查询则是指查询返回多个列数据的子查询语句</span></p> <br><ul><li>查询和SMITH的部门和岗位完全相同的所有雇员，不包含SMITH本人</li></ul> <br><pre><code class="language-sql">mysql> select * from emp <br>     > where (deptno,job)=(select deptno,job from emp where ename='SMITH')<br>     > and ename<>'SMITH';<br>+--------+-------+-------+------+---------------------+---------+------+--------+<br>| empno  | ename | job   | mgr  | hiredate            | sal     | comm | deptno |<br>+--------+-------+-------+------+---------------------+---------+------+--------+<br>| 007876 | ADAMS | CLERK | 7788 | 1987-05-23 00:00:00 | 1100.00 | NULL |     20 |<br>+--------+-------+-------+------+---------------------+---------+------+--------+<br>1 row in set (0.00 sec)</code></pre> <br><h3>在from子句中使用子查询</h3> <br><p style="text-align:center;">子<span style="color:#333333;">查询语句出现在</span><span style="color:#333333;">from</span><span style="color:#333333;">子句中。这里要用到数据查询的技巧，把一个子查询当做一个临时表使用。</span><em><span style="color:#be191c;"><strong>在MySql中，一切皆为表。</strong></span></em></p> <br><ul><li>显示高于自己部门平均工资的员工的姓名、部门、工资、平均工资</li></ul> <br><pre><code class="language-sql">mysql> select emp.ename, emp.deptno, emp.sal, format(avg_sal,2) from<br>     > emp, (select avg(sal) avg_sal, deptno dpt from emp group by deptno) tmp <br>     > where emp.sal>avg_sal and emp.deptno=tmp.dpt;<br>+-------+--------+---------+-------------------+<br>| ename | deptno | sal     | format(avg_sal,2) |<br>+-------+--------+---------+-------------------+<br>| FORD  |     20 | 3000.00 | 2,175.00          |<br>| SCOTT |     20 | 3000.00 | 2,175.00          |<br>| JONES |     20 | 2975.00 | 2,175.00          |<br>| BLAKE |     30 | 2850.00 | 1,566.67          |<br>| ALLEN |     30 | 1600.00 | 1,566.67          |<br>| KING  |     10 | 5000.00 | 2,916.67          |<br>+-------+--------+---------+-------------------+<br>6 rows in set (0.00 sec)</code></pre> <br><ul><li>查找每个部门工资最高的人的姓名、工资、部门、最高工资</li></ul> <br><pre><code class="language-sql">mysql> select ename, sal, emp.deptno, max_sal from <br>     > emp,(select deptno,max(sal) max_sal from emp group by deptno) tmp <br>     > where emp.deptno=tmp.deptno and max_sal=sal;<br>+-------+---------+--------+---------+<br>| ename | sal     | deptno | max_sal |<br>+-------+---------+--------+---------+<br>| BLAKE | 2850.00 |     30 | 2850.00 |<br>| SCOTT | 3000.00 |     20 | 3000.00 |<br>| KING  | 5000.00 |     10 | 5000.00 |<br>| FORD  | 3000.00 |     20 | 3000.00 |<br>+-------+---------+--------+---------+<br>4 rows in set (0.00 sec)</code></pre> <br><ul><li>显示每个部门的信息（部门名、编号、地址）和人员数量</li></ul> <br><p><span style="color:#b95514;">使用子查询 </span></p> <br><pre><code class="language-sql">mysql> select dept.deptno, dname, cnt, loc from <br>     > dept, (select count(*) cnt,deptno from emp group by deptno) tmp <br>     > where dept.deptno=tmp.deptno;<br>+--------+------------+-----+----------+<br>| deptno | dname      | cnt | loc      |<br>+--------+------------+-----+----------+<br>|     10 | ACCOUNTING |   3 | NEW YORK |<br>|     20 | RESEARCH   |   5 | DALLAS   |<br>|     30 | SALES      |   6 | CHICAGO  |<br>+--------+------------+-----+----------+<br>3 rows in set (0.00 sec)</code></pre> <br><p><span style="color:#b95514;">使用多表（复杂、不建议） </span></p> <br><pre><code class="language-sql">mysql> select dept.deptno, dept.dname, dept.loc, count(*) <br>     > from emp,dept where dept.deptno=emp.deptno <br>     > group by dept.deptno,dept.dname,dept.loc;<br>+--------+------------+----------+----------+<br>| deptno | dname      | loc      | count(*) |<br>+--------+------------+----------+----------+<br>|     20 | RESEARCH   | DALLAS   |        5 |<br>|     30 | SALES      | CHICAGO  |        6 |<br>|     10 | ACCOUNTING | NEW YORK |        3 |<br>+--------+------------+----------+----------+<br>3 rows in set (0.00 sec)</code></pre> <br><h2> 合并查询</h2> <br><div> <br> <span style="color:#333333;">在实际应用中，为了合并多个</span> <br> <span style="color:#333333;">select</span> <br> <span style="color:#333333;">的执行结果，可以使用集合操作符</span> <br> <span style="color:#333333;"> union</span> <br> <span style="color:#333333;">，</span> <br> <span style="color:#333333;">union all</span> <br></div> <br><h3>union</h3> <br><div> <br> <span style="color:#333333;">该操作符用于取得两个结果集的并集。当使用该操作符时，会自动去掉结果集中的重复行。</span> <br></div> <br><div></div> <br><ul><li> 将工资大于2500或职位是MANAGER的人找出来</li></ul> <br><pre><code class="language-sql">mysql> select ename, sal, job from EMP where sal>2500 union<br>     > select ename, sal, job from EMP where job='MANAGER';--去掉了重复记录<br>+-------+---------+-----------+<br>| ename | sal     | job       |<br>+-------+---------+-----------+<br>| JONES | 2975.00 | MANAGER   |<br>| BLAKE | 2850.00 | MANAGER   |<br>| SCOTT | 3000.00 | ANALYST   |<br>| KING  | 5000.00 | PRESIDENT |<br>| FORD  | 3000.00 | ANALYST   |<br>| CLARK | 2450.00 | MANAGER   |<br>+-------+---------+-----------+</code></pre> <br><h3 style="background-color:transparent;">union all</h3> <br><p> <span style="color:#333333;">该操作符用于取得两个结果集的并集。当使用该操作符时，不会去掉结果集中的重复行。</span></p> <br><ul><li> <span style="color:#333333;">将工资大于</span><span style="color:#333333;">25000</span><span style="color:#333333;">或职位是</span><span style="color:#333333;">MANAGER的人找出来 </span></li></ul> <br><pre><code class="language-sql">mysql> select ename, sal, job from EMP where sal>2500 union all<br>     > select ename, sal, job from EMP where job='MANAGER';<br>+-------+---------+-----------+<br>| ename | sal     | job       |<br>+-------+---------+-----------+<br>| JONES | 2975.00 | MANAGER   |<br>| BLAKE | 2850.00 | MANAGER   |<br>| SCOTT | 3000.00 | ANALYST   |<br>| KING  | 5000.00 | PRESIDENT |<br>| FORD  | 3000.00 | ANALYST   |<br>| JONES | 2975.00 | MANAGER   |<br>| BLAKE | 2850.00 | MANAGER   |<br>| CLARK | 2450.00 | MANAGER   |<br>+-------+---------+-----------+<br></code></pre> <br><h2 style="background-color:transparent;"> 内连接</h2> <br><p>内连接实际上就是利用where子句对两种表形成的笛卡尔积进行筛选，是再开发过程中使用得最多的连接查询</p> <br><p>语法：</p> <br><pre><code class="language-sql">select 字段 from 表一 inner join 表二 on 连接条件 and 其他条件;</code></pre> <br><h2>外连接</h2> <br><p>外连接分为左外连接和右外连接</p> <br><h3>左外连接</h3> <br><p>联合查询时，如果在左侧的表需要完全显示，我们就用左外连接</p> <br><p>语法：</p> <br><pre><code class="language-sql">select 字段 from 表一 left join 表二 on 连接条件</code></pre> <br><h3>右外连接</h3> <br><p>联合查询时，如果右侧的表需要完全显示，我们就右外连接</p> <br><pre><code class="language-sql">select 字段 from 表一 right join 表二 on 连接条件</code></pre> <br><p style="text-align:center;"><strong>本期博客到这里就结束了，如果有什么错误，欢迎指出，如果对你有帮助，请点个赞，谢谢！</strong> </p>